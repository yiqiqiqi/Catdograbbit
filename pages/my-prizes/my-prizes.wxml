<view class="container">
  <!-- 页面标题 -->
  <view class="page-header">
    <text class="page-title">我的奖品</text>
  </view>

  <!-- 加载状态 -->
  <view class="loading-container" wx:if="{{loading}}">
    <view class="loading-text">加载中...</view>
  </view>

  <!-- 奖品列表 -->
  <view class="prizes-list" wx:if="{{!loading && prizesList.length > 0}}">
    <view
      class="prize-card"
      wx:for="{{prizesList}}"
      wx:key="id"
    >
      <view class="decorative-corner top-left"></view>
      <view class="decorative-corner bottom-right"></view>

      <!-- 奖品图标 -->
      <view class="prize-icon-wrapper">
        <text class="prize-icon">{{item.prizeIcon}}</text>
      </view>

      <!-- 奖品信息 -->
      <view class="prize-info">
        <view class="prize-name">{{item.prizeName}}</view>
        <view class="prize-time">{{item.winTime}}</view>
        <view class="prize-expire">有效期至：{{item.expireTime}}</view>
      </view>

      <!-- 状态和操作 -->
      <view class="prize-action">
        <!-- 未使用 -->
        <view
          class="status-btn available"
          wx:if="{{item.status === 0}}"
          bindtap="usePrize"
          data-id="{{item.id}}"
        >
          <text>使用</text>
        </view>

        <!-- 已使用 -->
        <view
          class="status-btn used"
          wx:elif="{{item.status === 1}}"
        >
          <text>已使用</text>
        </view>

        <!-- 已过期 -->
        <view
          class="status-btn expired"
          wx:else
        >
          <text>已过期</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view class="empty-container" wx:if="{{!loading && prizesList.length === 0}}">
    <view class="empty-card">
      <text class="empty-icon">🎁</text>
      <text class="empty-text">暂无奖品</text>
      <text class="empty-tip">快去抽奖赢取好礼吧！</text>
      <view class="empty-btn" bindtap="goToLottery">
        <text>立即抽奖</text>
      </view>
    </view>
  </view>
</view>

<!-- 核销码弹窗 -->
<view class="redeem-modal {{showRedeemModal ? 'show' : ''}}" catchtap="closeRedeemModal">
  <view class="modal-content" catchtap="preventClose">
    <view class="modal-card">
      <view class="modal-title">奖品核销码</view>

      <view class="prize-display">
        <text class="prize-icon-large">{{currentPrize.prizeIcon}}</text>
        <text class="prize-name-text">{{currentPrize.prizeName}}</text>
      </view>

      <view class="redeem-code-display">
        <text class="code-text">{{redeemCode}}</text>
      </view>

      <view class="modal-tip">
        <text>请向店员出示此核销码</text>
      </view>

      <view class="modal-btn primary" bindtap="closeRedeemModal">
        <text>知道了</text>
      </view>
    </view>
  </view>
</view>
