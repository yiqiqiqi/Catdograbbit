<view class="container">
  <!-- é¡µé¢æ ‡é¢˜ -->
  <view class="page-header">
    <text class="page-title">ç§¯åˆ†ä¸­å¿ƒ</text>
  </view>

  <!-- ç§¯åˆ†æ€»è§ˆå¡ç‰‡ -->
  <view class="points-overview-card">
    <view class="decorative-line top"></view>
    <view class="decorative-line bottom"></view>

    <view class="overview-content">
      <view class="main-points">
        <text class="points-label">å½“å‰ç§¯åˆ†</text>
        <text class="points-value">{{userPoints}}</text>
      </view>

      <view class="stats-row">
        <view class="stat-item">
          <text class="stat-label">ç­‰çº§</text>
          <text class="stat-value">Lv.{{userLevel}}</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-label">æœ¬æœˆç´¯è®¡</text>
          <text class="stat-value">{{monthlyPoints}}</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-label">æŠ½å¥–åˆ¸</text>
          <text class="stat-value highlight">{{lotteryTickets}}å¼ </text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¿«æ·å…‘æ¢åŒº -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">å¿«æ·å…‘æ¢</text>
    </view>

    <view class="exchange-grid">
      <!-- çŒ«ç ‚å…å•åˆ¸ -->
      <view class="exchange-card" bindtap="handleExchange" data-id="1">
        <view class="exchange-icon-wrapper free">
          <text class="exchange-icon">ğŸ</text>
        </view>
        <view class="exchange-info">
          <text class="exchange-name">çŒ«ç ‚å…å•åˆ¸</text>
          <text class="exchange-price">1000ç§¯åˆ†</text>
        </view>
        <view class="exchange-btn">
          <text>å…‘æ¢</text>
        </view>
      </view>

      <!-- æŠ½å¥–åˆ¸Ã—1 -->
      <view class="exchange-card" bindtap="handleExchange" data-id="2">
        <view class="exchange-icon-wrapper ticket">
          <text class="exchange-icon">ğŸ«</text>
        </view>
        <view class="exchange-info">
          <text class="exchange-name">æŠ½å¥–åˆ¸Ã—1</text>
          <text class="exchange-price">100ç§¯åˆ†</text>
        </view>
        <view class="exchange-btn">
          <text>å…‘æ¢</text>
        </view>
      </view>

      <!-- æŠ½å¥–åˆ¸Ã—10 -->
      <view class="exchange-card hot" bindtap="handleExchange" data-id="3">
        <view class="hot-badge">9æŠ˜</view>
        <view class="exchange-icon-wrapper ticket-pack">
          <text class="exchange-icon">ğŸŸï¸</text>
        </view>
        <view class="exchange-info">
          <text class="exchange-name">æŠ½å¥–åˆ¸Ã—10</text>
          <view class="price-group">
            <text class="exchange-price-old">1000</text>
            <text class="exchange-price">900ç§¯åˆ†</text>
          </view>
        </view>
        <view class="exchange-btn primary">
          <text>å…‘æ¢</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç§¯åˆ†æ˜ç»† -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ç§¯åˆ†æ˜ç»†</text>
      <view class="filter-tabs">
        <text
          class="filter-tab {{filterType === 'all' ? 'active' : ''}}"
          bindtap="switchFilter"
          data-type="all"
        >å…¨éƒ¨</text>
        <text
          class="filter-tab {{filterType === 'income' ? 'active' : ''}}"
          bindtap="switchFilter"
          data-type="income"
        >æ”¶å…¥</text>
        <text
          class="filter-tab {{filterType === 'expense' ? 'active' : ''}}"
          bindtap="switchFilter"
          data-type="expense"
        >æ”¯å‡º</text>
      </view>
    </view>

    <!-- æ˜ç»†åˆ—è¡¨ -->
    <view class="history-list" wx:if="{{historyList.length > 0}}">
      <view
        class="history-item"
        wx:for="{{historyList}}"
        wx:key="id"
      >
        <view class="history-icon {{item.type}}">
          <text>{{item.icon}}</text>
        </view>
        <view class="history-info">
          <text class="history-reason">{{item.reason}}</text>
          <text class="history-time">{{item.time}}</text>
        </view>
        <view class="history-amount {{item.type}}">
          <text>{{item.type === 'income' ? '+' : '-'}}{{item.amount}}</text>
        </view>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view class="empty-state" wx:if="{{historyList.length === 0 && !loading}}">
      <text class="empty-icon">ğŸ“</text>
      <text class="empty-text">æš‚æ— ç§¯åˆ†è®°å½•</text>
    </view>

    <!-- åŠ è½½çŠ¶æ€ -->
    <view class="loading-state" wx:if="{{loading}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
  </view>
</view>
