<view class="container">
  <!-- å® ç‰©é€‰æ‹©å™¨ -->
  <view class="pet-section">
    <pet-picker
      selectedPet="{{selectedPet}}"
      petList="{{petList}}"
      bind:petChange="onPetChange"
      bind:editPet="onEditPet"
    />
  </view>

  <!-- å® ç‰©æ¡£æ¡ˆä¿¡æ¯ -->
  <view wx:if="{{selectedPet}}" class="pet-info-card">
    <view class="pet-profile">
      <view class="pet-basic-info">
        <view class="info-item">
          <text class="info-label">æ˜µç§°</text>
          <text class="info-value">{{selectedPet.name}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">å“ç§</text>
          <text class="info-value">{{selectedPet.breed || 'æœªå¡«å†™'}}</text>
        </view>
      </view>
      <view class="pet-date-info">
        <view class="info-item">
          <text class="info-label">åˆ°å®¶æ—¥æœŸ</text>
          <text class="info-value">{{selectedPet.adoptionDate || 'æœªå¡«å†™'}}</text>
        </view>
        <view class="info-item">
          <text class="info-label">ç”Ÿæ—¥</text>
          <text class="info-value">{{selectedPet.birthDate || 'æœªå¡«å†™'}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- æ·»åŠ æˆé•¿è®°å½•æŒ‰é’® -->
  <view class="add-record-btn-section">
    <button class="add-record-btn" bindtap="addGrowthRecord" wx:if="{{selectedPet}}">
      <text class="btn-icon">+</text>
      <text>æ·»åŠ æˆé•¿è®°å½•</text>
      <text class="btn-tip">æ¯æ—¥å¯è·å¾—5ç§¯åˆ†</text>
    </button>
  </view>

  <!-- æˆé•¿è®°å½•åˆ—è¡¨ -->
  <view wx:if="{{selectedPet && growthRecords.length > 0}}" class="records-section">
    <text class="section-title">æˆé•¿è®°å½•åˆ—è¡¨</text>
    <view class="records-list">
      <block wx:for="{{growthRecords}}" wx:key="id">
        <view class="record-card">
          <view class="record-header">
            <text class="record-date">{{item.recordDate}}</text>
            <view class="record-badge" wx:if="{{item.pointsEarned}}">
              <text class="badge-text">+{{item.pointsEarned}}ç§¯åˆ†</text>
            </view>
          </view>
          <text class="record-content">{{item.content}}</text>

          <!-- å›¾ç‰‡å±•ç¤º -->
          <view wx:if="{{item.images && item.images.length > 0}}" class="record-images">
            <block wx:for="{{item.images}}" wx:key-item="image" wx:for-index="idx">
              <image
                src="{{image}}"
                class="record-image"
                mode="aspectFill"
                bindtap="previewImage"
                data-urls="{{item.images}}"
                data-current="{{idx}}"
              />
            </block>
          </view>

          <view class="record-footer">
            <text class="record-title">{{item.title}}</text>
            <view class="record-actions">
              <button class="action-btn" bindtap="editRecord" data-id="{{item.id}}">ç¼–è¾‘</button>
              <button class="action-btn delete" bindtap="deleteRecord" data-id="{{item.id}}">åˆ é™¤</button>
            </view>
          </view>
        </view>
      </block>
    </view>

    <!-- åŠ è½½æ›´å¤š -->
    <view wx:if="{{hasMore}}" class="load-more-section">
      <button class="load-more-btn" bindtap="loadMore" disabled="{{isLoadingMore}}">
        {{isLoadingMore ? 'åŠ è½½ä¸­...' : 'åŠ è½½æ›´å¤š'}}
      </button>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:if="{{selectedPet && growthRecords.length === 0 && !loading}}" class="empty-state">
    <text class="empty-icon">ğŸ“</text>
    <text class="empty-text">è¿˜æ²¡æœ‰æˆé•¿è®°å½•</text>
    <text class="empty-tip">ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€æ¡è®°å½•å§ï¼</text>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-state">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>

  <!-- æœªé€‰æ‹©å® ç‰©æç¤º -->
  <view wx:if="{{!selectedPet && petList.length === 0 && !loading}}" class="no-pet-state">
    <text class="no-pet-icon">ğŸ¾</text>
    <text class="no-pet-text">è¿˜æ²¡æœ‰å® ç‰©ï¼Œå¿«å»æ·»åŠ ä¸€åªå§ï¼</text>
  </view>
</view>
